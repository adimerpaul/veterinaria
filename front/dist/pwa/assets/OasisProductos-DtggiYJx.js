import{c as p,o as u,w as a,a as t,b as r,Q as b,e as g,an as d,d as f,f as c,a1 as y,a0 as V,a2 as E,a3 as _,W as h,Z as v,_ as P,t as n,h as w,aq as D}from"./index-DQ968X6Q.js";import{Q as x}from"./QForm-CsIXe42i.js";import{Q as N}from"./QPagination-o4vY85Ua.js";import{Q as C,a as m}from"./QMenu-D_7tsJxk.js";import{Q as U,a as S}from"./QList-DxafYJMR.js";import{Q as T}from"./QMarkupTable-Cd8hJ3fy.js";import{Q as B}from"./QSpace-BHk0gvGJ.js";import{Q as G}from"./QPage-BiqGBz3F.js";import{C as k}from"./ClosePopup-B3TnWG9D.js";import{E as q}from"./Excel-CKQ98bqC.js";import{_ as O}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./format-DyQxkAtJ.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";const z={name:"OasisProductosPage",data(){return{tipos:["Cirugía","Laboratorio","Peluqueria","Producto","Tratamiento"],productos:[],producto:{},productoDialog:!1,loading:!1,actionProducto:"",filter:"",filterTipo:"Todos",totalPages:1,currentPage:1}},mounted(){this.productosGet()},methods:{exportarExcel(){const s=[{sheet:"Productos",columns:[{label:"Código",value:"codigo"},{label:"Nombre",value:"nombre"},{label:"Precio Compra",value:"precioCompra"},{label:"Precio Venta",value:"precioVenta"},{label:"Stock",value:"stock"},{label:"Empresa",value:"empresa"},{label:"Proveedor",value:"proveedor"}],content:this.productos}];q.export(s,"Productos")},getColor(s){switch(s){case"Cirugía":return"red";case"Laboratorio":return"blue";case"Peluqueria":return"green";case"Producto":return"orange";case"Tratamiento":return"purple";default:return"grey"}},productoNew(){this.producto={codigo:"",nombre:"",precioCompra:0,precioVenta:0,stock:0,tipo:"Producto"},this.actionProducto="Nuevo",this.productoDialog=!0},productosGet(){this.loading=!0,this.$axios.get("oasis-productos",{params:{filter:this.filter,page:this.currentPage,limit:20,tipo:this.filterTipo==="Todos"?"":this.filterTipo}}).then(s=>{this.productos=s.data.data,this.totalPages=s.data.last_page}).catch(s=>{this.$alert.error(s.response?.data?.message||"Error al cargar")}).finally(()=>{this.loading=!1})},productoPost(){this.loading=!0,this.$axios.post("oasis-productos",this.producto).then(()=>{this.productoDialog=!1,this.productosGet(),this.$alert.success("Creado correctamente")}).catch(s=>{this.$alert.error(s.response?.data?.message||"Error al crear")}).finally(()=>{this.loading=!1})},productoPut(){this.loading=!0,this.$axios.put(`oasis-productos/${this.producto.id}`,this.producto).then(()=>{this.productoDialog=!1,this.productosGet(),this.$alert.success("Actualizado correctamente")}).catch(s=>{this.$alert.error(s.response?.data?.message||"Error al actualizar")}).finally(()=>{this.loading=!1})},productoEdit(s){this.producto={...s},this.actionProducto="Editar",this.productoDialog=!0},productoDelete(s){this.$alert.dialog("¿Eliminar producto?").onOk(()=>{this.loading=!0,this.$axios.delete(`oasis-productos/${s}`).then(()=>{this.productosGet(),this.$alert.success("Eliminado correctamente")}).catch(o=>{this.$alert.error(o.response?.data?.message||"Error al eliminar")}).finally(()=>{this.loading=!1})})}}},I={class:"row"},L={class:"col-8 col-md-3"},F={class:"col-4 col-md-2"},M={class:"col-4 col-md-2 flex flex-center"},A={class:"col-12 col-md-5 text-right"},R={class:"row"},W={class:"col-12 flex flex-center"},Z={class:"text-bold text-sub"},j={class:"text-right"};function H(s,o,J,K,e,i){return u(),p(G,{class:"q-pa-md"},{default:a(()=>[t(b,{flat:"",bordered:""},{default:a(()=>[t(g,null,{default:a(()=>[t(x,{onSubmit:i.productosGet},{default:a(()=>[r("div",I,[r("div",L,[t(d,{modelValue:e.filter,"onUpdate:modelValue":o[0]||(o[0]=l=>e.filter=l),label:"Buscar",outlined:"",dense:"",clearable:""},{prepend:a(()=>[t(f,{name:"search"})]),_:1},8,["modelValue"])]),r("div",F,[t(c,{color:"primary",label:"Buscar",type:"submit","no-caps":"",icon:"search",loading:e.loading},null,8,["loading"])]),r("div",M,[t(c,{color:"secondary",label:"Exportar Excel",onClick:i.exportarExcel,"no-caps":"",icon:"save_alt",loading:e.loading},null,8,["onClick","loading"])]),r("div",A,[t(c,{color:"positive",label:"Nuevo",onClick:i.productoNew,"no-caps":"",icon:"add_circle_outline",loading:e.loading},null,8,["onClick","loading"])])])]),_:1},8,["onSubmit"]),r("div",R,[r("div",W,[e.totalPages>1?(u(),p(N,{key:0,modelValue:e.currentPage,"onUpdate:modelValue":[o[1]||(o[1]=l=>e.currentPage=l),i.productosGet],max:e.totalPages,"max-pages":5,"boundary-numbers":"",color:"black"},null,8,["modelValue","max","onUpdate:modelValue"])):y("",!0)])]),t(T,{dense:"","wrap-cells":"",flat:"",bordered:""},{default:a(()=>[o[15]||(o[15]=r("thead",{class:"bg-black text-white"},[r("tr",null,[r("td",null,"Opciones"),r("td",null,"Codigo"),r("td",null,"Nombre"),r("td",null,"Precio Compra"),r("td",null,"Precio Venta"),r("td",null,"Stock"),r("td",null,"Empresa"),r("td",null,"Proveedor")])],-1)),r("tbody",null,[(u(!0),V(E,null,_(e.productos,l=>(u(),V("tr",{key:l.id},[r("td",null,[t(U,{dense:"",size:"10px",label:"Opciones","no-caps":"","dropdown-icon":"more_vert",color:"orange",loading:e.loading},{default:a(()=>[t(S,null,{default:a(()=>[h((u(),p(C,{clickable:"",onClick:Q=>i.productoEdit(l)},{default:a(()=>[t(m,{avatar:""},{default:a(()=>[t(f,{name:"edit"})]),_:1}),t(m,null,{default:a(()=>o[13]||(o[13]=[v("Editar")])),_:1})]),_:2},1032,["onClick"])),[[P],[k]]),h((u(),p(C,{clickable:"",onClick:Q=>i.productoDelete(l.id)},{default:a(()=>[t(m,{avatar:""},{default:a(()=>[t(f,{name:"delete"})]),_:1}),t(m,null,{default:a(()=>o[14]||(o[14]=[v("Eliminar")])),_:1})]),_:2},1032,["onClick"])),[[P],[k]])]),_:2},1024)]),_:2},1032,["loading"])]),r("td",null,n(l.codigo),1),r("td",null,n(l.nombre),1),r("td",null,n(l.precioCompra),1),r("td",null,n(l.precioVenta),1),r("td",null,n(l.stock),1),r("td",null,n(l.empresa),1),r("td",null,n(l.proveedor),1)]))),128))])]),_:1})]),_:1})]),_:1}),t(w,{modelValue:e.productoDialog,"onUpdate:modelValue":o[12]||(o[12]=l=>e.productoDialog=l),persistent:"",position:"right",maximized:""},{default:a(()=>[t(b,{style:{"min-width":"350px"}},{default:a(()=>[t(g,{class:"q-pb-none row items-center"},{default:a(()=>[r("div",Z,n(e.actionProducto)+" Oasis Producto ",1),t(B),t(c,{icon:"close",flat:"",round:"",dense:"",onClick:o[2]||(o[2]=l=>e.productoDialog=!1)})]),_:1}),t(g,null,{default:a(()=>[t(x,{onSubmit:o[11]||(o[11]=D(l=>e.producto.id?i.productoPut():i.productoPost(),["prevent"]))},{default:a(()=>[t(d,{modelValue:e.producto.codigo,"onUpdate:modelValue":o[3]||(o[3]=l=>e.producto.codigo=l),label:"Codigo",outlined:"",dense:""},null,8,["modelValue"]),t(d,{modelValue:e.producto.nombre,"onUpdate:modelValue":o[4]||(o[4]=l=>e.producto.nombre=l),label:"Nombre",outlined:"",dense:""},null,8,["modelValue"]),t(d,{modelValue:e.producto.precioCompra,"onUpdate:modelValue":o[5]||(o[5]=l=>e.producto.precioCompra=l),label:"Precio Compra",outlined:"",dense:"",type:"number",step:"0.01"},null,8,["modelValue"]),t(d,{modelValue:e.producto.precioVenta,"onUpdate:modelValue":o[6]||(o[6]=l=>e.producto.precioVenta=l),label:"Precio Venta",outlined:"",dense:"",type:"number",step:"0.01"},null,8,["modelValue"]),t(d,{modelValue:e.producto.stock,"onUpdate:modelValue":o[7]||(o[7]=l=>e.producto.stock=l),label:"Stock",outlined:"",dense:"",type:"number"},null,8,["modelValue"]),t(d,{modelValue:e.producto.empresa,"onUpdate:modelValue":o[8]||(o[8]=l=>e.producto.empresa=l),label:"Empresa Proveedora",outlined:"",dense:""},null,8,["modelValue"]),t(d,{modelValue:e.producto.proveedor,"onUpdate:modelValue":o[9]||(o[9]=l=>e.producto.proveedor=l),label:"Proveedor",outlined:"",dense:""},null,8,["modelValue"]),r("div",j,[t(c,{color:"negative",label:"Cancelar",onClick:o[10]||(o[10]=l=>e.productoDialog=!1),"no-caps":"",loading:e.loading},null,8,["loading"]),t(c,{color:"primary",label:"Guardar",type:"submit","no-caps":"",class:"q-ml-sm",loading:e.loading},null,8,["loading"])])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),o[16]||(o[16]=r("div",{id:"myElement",style:{display:"none"}},null,-1))]),_:1})}const po=O(z,[["render",H]]);export{po as default};
