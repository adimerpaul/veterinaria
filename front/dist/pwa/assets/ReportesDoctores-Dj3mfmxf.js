import{g as v,r as T,c as x,o as u,w as m,a as d,Q as k,a8 as C,e as y,at as O,f as D,I as _,a7 as f,a9 as F,aa as S,b as e,t as c}from"./index-ionkigSd.js";import{Q as B}from"./QMarkupTable-B024LqnU.js";import{Q}from"./QPage-_rBYZMUl.js";import{E as R}from"./jspdf.es.min-46_rsrRl.js";import{a as N}from"./jspdf.plugin.autotable-CZ1gY-nI.js";import{h as P}from"./moment-C5S46NFB.js";function w(g,b){const t=new R({orientation:"portrait",unit:"mm",format:"A4"}),r=new Date(b).toLocaleDateString();t.setFontSize(16),t.text("REPORTE DE TRATAMIENTOS POR DOCTOR",14,15),t.setFontSize(10),t.text(`Fecha: ${r}`,14,22);let a=28;for(const p in g){const i=g[p],o=i.length,n=i.reduce((l,s)=>l+Number(s.costo),0).toFixed(2);t.setFontSize(10),t.text(`Doctor: ${p}`,12,a),N(t,{startY:a+4,head:[["Nro Ficha","Detalle","Cant","Bs"]],body:i.map(l=>[l.nroFicha,l.detalle,"1",l.costo]),styles:{fontSize:8,cellPadding:1.5},margin:{left:12,right:12},theme:"grid",headStyles:{fillColor:[22,160,133],fontSize:8},didDrawPage:function(l){a=l.cursor.y}}),t.setFontSize(10),t.setFont(void 0,"bold"),t.text(`TOTAL TRATAMIENTOS: ${o}`,100,a+6),t.text(`TOTAL Bs: ${n}`,180,a+6,{align:"right"}),t.setFont(void 0,"normal"),a+=8,a>260&&(t.addPage(),a=20)}t.save(`Reporte-Tratamientos-${r}.pdf`)}const A={class:"text-h6 text-primary"},E={class:"bg-blue-1 text-bold"},M={__name:"ReportesDoctores",setup(g){const{proxy:b}=v(),t=T(P().format("YYYY-MM-DD")),r=T({}),a=async()=>{if(!t.value)return;const{data:i}=await b.$axios.get("/tratamientos/reporte-por-doctor",{params:{fecha:t.value}});r.value=i},p=()=>{w(r.value,t.value)};return(i,o)=>(u(),x(Q,{class:"q-pa-md bg-grey-2"},{default:m(()=>[d(k,null,{default:m(()=>[d(y,{class:"row q-gutter-sm"},{default:m(()=>[d(O,{modelValue:t.value,"onUpdate:modelValue":o[0]||(o[0]=n=>t.value=n),label:"Selecciona Fecha",type:"date",outlined:"",dense:"",class:"col-4"},null,8,["modelValue"]),d(D,{label:"Buscar",color:"primary",onClick:a}),d(D,{label:"Exportar PDF",color:"deep-orange",icon:"picture_as_pdf",onClick:p,disable:Object.keys(r.value).length===0},null,8,["disable"])]),_:1}),d(_),Object.keys(r.value).length>0?(u(),x(y,{key:0},{default:m(()=>[(u(!0),f(F,null,S(r.value,(n,l)=>(u(),f("div",{key:l,class:"q-mb-md"},[e("div",A,c(l),1),d(B,{dense:"",bordered:"",flat:"",class:"bg-white text-center"},{default:m(()=>[o[3]||(o[3]=e("thead",null,[e("tr",null,[e("th",null,"Nro Ficha"),e("th",null,"Detalle"),e("th",null,"Cant"),e("th",null,"Bs")])],-1)),e("tbody",null,[(u(!0),f(F,null,S(n,(s,h)=>(u(),f("tr",{key:h},[e("td",null,c(s.nroFicha),1),e("td",null,c(s.detalle),1),o[1]||(o[1]=e("td",null,"1",-1)),e("td",null,c(s.costo),1)]))),128)),e("tr",E,[o[2]||(o[2]=e("td",{colspan:"2"},"TOTAL",-1)),e("td",null,c(n.length),1),e("td",null,c(n.reduce((s,h)=>s+Number(h.costo),0)),1)])])]),_:2},1024)]))),128))]),_:1})):C("",!0)]),_:1})]),_:1}))}};export{M as default};
