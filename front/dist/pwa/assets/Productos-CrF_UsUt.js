import{c as p,o as n,w as i,a as l,Q as f,e as m,b as r,al as u,d as _,f as c,a1 as y,a0 as h,a2 as w,a3 as D,W as b,Z as g,_ as V,t as d,h as T,ao as U}from"./index-NqseHGZw.js";import{Q as P,b as E}from"./QSelect-DKr3NEIe.js";import{Q as C}from"./QForm-Bkgk7FjF.js";import{Q as N}from"./QPagination-TlkylWlt.js";import{Q,a as k}from"./format-D0AoCP8y.js";import{Q as S}from"./QList-nrkPbQe2.js";import{Q as B,C as x}from"./ClosePopup-BVvjsbMb.js";import{Q as G}from"./QMarkupTable-DskCBd_G.js";import{Q as L}from"./QSpace-BDpUjM-P.js";import{Q as q}from"./QPage-CfgRLsR5.js";import{_ as z}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./QItemLabel-DA4-Yr_F.js";const I={name:"ProductosPage",data(){return{tipos:["Cirugía","Laboratorio","Peluqueria","Producto","Tratamiento"],productos:[],productosAll:[],producto:{},productoDialog:!1,loading:!1,actionProducto:"",filter:"",filterTipo:"Todos",totalPages:1,currentPage:1}},mounted(){this.productosGet()},methods:{getColor(s){switch(s){case"Cirugía":return"red";case"Laboratorio":return"blue";case"Peluqueria":return"green";case"Producto":return"orange";case"Tratamiento":return"purple";default:return"grey"}},productosFilter(){this.filter?this.productos=this.productosAll.filter(s=>s.nombre.toLowerCase().includes(this.filter.toLowerCase())):this.productos=this.productosAll},productoNew(){this.producto={medicamento:"",forma_farmaceutica:"",concentracion:"",precio:0,stock:0,tipo:"Producto",imagen:null,categoria_id:null},this.actionProducto="Nuevo",this.productoDialog=!0},productosGet(){this.loading=!0,this.$axios.get("productos",{params:{filter:this.filter,page:this.currentPage,limit:20,tipo:this.filterTipo==="Todos"?"":this.filterTipo}}).then(s=>{this.productos=s.data.data,this.totalPages=s.data.last_page}).catch(s=>{this.$alert.error(s.response?.data?.message||"Error al cargar productos")}).finally(()=>{this.loading=!1})},productoPost(){this.loading=!0,this.$axios.post("productos",this.producto).then(()=>{this.productoDialog=!1,this.productosGet(),this.$alert.success("Producto creado correctamente")}).catch(s=>{this.$alert.error(s.response?.data?.message||"Error al crear producto")}).finally(()=>{})},productoPut(){this.loading=!0,this.$axios.put(`productos/${this.producto.id}`,this.producto).then(()=>{this.productoDialog=!1,this.productosGet(),this.$alert.success("Producto actualizado correctamente")}).catch(s=>{this.$alert.error(s.response?.data?.message||"Error al actualizar producto")}).finally(()=>{this.loading=!1})},productoEdit(s){this.producto={...s},this.actionProducto="Editar",this.productoDialog=!0},productoDelete(s){this.$alert.dialog("¿Desea eliminar el producto?").onOk(()=>{this.loading=!0,this.$axios.delete(`productos/${s}`).then(()=>{this.productosGet(),this.$alert.success("Producto eliminado correctamente")}).catch(o=>{this.$alert.error(o.response?.data?.message||"Error al eliminar producto")}).finally(()=>{this.loading=!1})})}}},A={class:"row"},F={class:"col-8 col-md-3"},O={class:"col-4 col-md-2"},M={class:"col-4 col-md-2 flex flex-center"},R={class:"col-12 col-md-5 text-right"},W={class:"row"},Z={class:"col-12 flex flex-center"},j={class:"text-bold text-sub"},H={class:"text-right"};function J(s,o,K,X,e,a){return n(),p(q,{class:"q-pa-md"},{default:i(()=>[l(f,{flat:"",bordered:""},{default:i(()=>[l(m,null,{default:i(()=>[l(C,{onSubmit:a.productosGet},{default:i(()=>[r("div",A,[r("div",F,[l(u,{modelValue:e.filter,"onUpdate:modelValue":o[0]||(o[0]=t=>e.filter=t),label:"Buscar",outlined:"",dense:"",clearable:""},{prepend:i(()=>[l(_,{name:"search"})]),_:1},8,["modelValue"])]),r("div",O,[l(P,{modelValue:e.filterTipo,"onUpdate:modelValue":o[1]||(o[1]=t=>e.filterTipo=t),label:"Tipo",outlined:"",dense:"",options:e.tipos},null,8,["modelValue","options"])]),r("div",M,[l(c,{color:"primary",label:"Buscar",type:"submit","no-caps":"",icon:"search",loading:e.loading},null,8,["loading"])]),r("div",R,[l(c,{color:"positive",label:"Nuevo",onClick:a.productoNew,"no-caps":"",icon:"add_circle_outline",loading:e.loading},null,8,["onClick","loading"])])])]),_:1},8,["onSubmit"]),r("div",W,[r("div",Z,[e.totalPages>1?(n(),p(N,{key:0,modelValue:e.currentPage,"onUpdate:modelValue":[o[2]||(o[2]=t=>e.currentPage=t),a.productosGet],max:e.totalPages,"max-pages":5,"boundary-numbers":"",color:"black"},null,8,["modelValue","max","onUpdate:modelValue"])):y("",!0)])]),l(G,{dense:"","wrap-cells":"",flat:"",bordered:""},{default:i(()=>[o[15]||(o[15]=r("thead",{class:"bg-black text-white"},[r("tr",null,[r("td",null,"Opciones"),r("td",null,"Codigo"),r("td",null,"Nombre"),r("td",null,"Precio Compra"),r("td",null,"Precio Venta"),r("td",null,"Stock"),r("td",null,"Tipo")])],-1)),r("tbody",null,[(n(!0),h(w,null,D(e.productos,t=>(n(),h("tr",{key:t.id},[r("td",null,[l(B,{dense:"",size:"10px",label:"Opciones","no-caps":"","dropdown-icon":"more_vert",color:"orange",loading:e.loading},{default:i(()=>[l(S,null,{default:i(()=>[b((n(),p(Q,{clickable:"",onClick:v=>a.productoEdit(t)},{default:i(()=>[l(k,null,{default:i(()=>o[13]||(o[13]=[g("Editar")])),_:1})]),_:2},1032,["onClick"])),[[V],[x]]),b((n(),p(Q,{clickable:"",onClick:v=>a.productoDelete(t.id)},{default:i(()=>[l(k,null,{default:i(()=>o[14]||(o[14]=[g("Eliminar")])),_:1})]),_:2},1032,["onClick"])),[[V],[x]])]),_:2},1024)]),_:2},1032,["loading"])]),r("td",null,d(t.codigo),1),r("td",null,d(t.nombre),1),r("td",null,d(t.precioCompra),1),r("td",null,d(t.precioVenta),1),r("td",null,d(t.stock),1),r("td",null,[l(E,{dense:"",color:a.getColor(t.tipo),size:"10px"},{default:i(()=>[g(d(t.tipo),1)]),_:2},1032,["color"])])]))),128))])]),_:1})]),_:1})]),_:1}),l(T,{modelValue:e.productoDialog,"onUpdate:modelValue":o[12]||(o[12]=t=>e.productoDialog=t),persistent:"",position:"right",maximized:""},{default:i(()=>[l(f,{style:{"min-width":"350px"}},{default:i(()=>[l(m,{class:"q-pb-none row items-center"},{default:i(()=>[r("div",j,d(e.actionProducto)+" Producto ",1),l(L),l(c,{icon:"close",flat:"",round:"",dense:"",onClick:o[3]||(o[3]=t=>e.productoDialog=!1)})]),_:1}),l(m,null,{default:i(()=>[l(C,{onSubmit:o[11]||(o[11]=U(t=>e.producto.id?a.productoPut():a.productoPost(),["prevent"]))},{default:i(()=>[l(u,{modelValue:e.producto.codigo,"onUpdate:modelValue":o[4]||(o[4]=t=>e.producto.codigo=t),label:"Codigo",outlined:"",dense:"",hint:""},null,8,["modelValue"]),l(u,{modelValue:e.producto.nombre,"onUpdate:modelValue":o[5]||(o[5]=t=>e.producto.nombre=t),label:"Nombre",outlined:"",dense:"",hint:""},null,8,["modelValue"]),l(u,{modelValue:e.producto.precioCompra,"onUpdate:modelValue":o[6]||(o[6]=t=>e.producto.precioCompra=t),label:"Precio Compra",outlined:"",dense:"",type:"number",step:"0.01",hint:""},null,8,["modelValue"]),l(u,{modelValue:e.producto.precioVenta,"onUpdate:modelValue":o[7]||(o[7]=t=>e.producto.precioVenta=t),label:"Precio Venta",outlined:"",dense:"",type:"number",step:"0.01",hint:""},null,8,["modelValue"]),l(u,{modelValue:e.producto.stock,"onUpdate:modelValue":o[8]||(o[8]=t=>e.producto.stock=t),label:"Stock",outlined:"",dense:"",type:"number",hint:""},null,8,["modelValue"]),l(P,{modelValue:e.producto.tipo,"onUpdate:modelValue":o[9]||(o[9]=t=>e.producto.tipo=t),label:"Tipo",outlined:"",dense:"",options:e.tipos,hint:""},null,8,["modelValue","options"]),r("div",H,[l(c,{color:"negative",label:"Cancelar",onClick:o[10]||(o[10]=t=>e.productoDialog=!1),"no-caps":"",loading:e.loading},null,8,["loading"]),l(c,{color:"primary",label:"Guardar",type:"submit","no-caps":"",class:"q-ml-sm",loading:e.loading},null,8,["loading"])])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const co=z(I,[["render",J]]);export{co as default};
