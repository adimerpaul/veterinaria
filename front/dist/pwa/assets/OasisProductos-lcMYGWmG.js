import{c as p,o as d,w as a,a as e,b as r,Q as b,e as g,al as n,d as f,f as c,a1 as y,a0 as h,a2 as _,a3 as w,W as V,Z as P,_ as C,t as u,h as D,ao as E}from"./index-Bb8ivEEu.js";import{Q as k}from"./QForm-CEjLaIW_.js";import{Q as N}from"./QPagination-1tWIiV1i.js";import{Q as v,a as m}from"./QMenu-qqDilsmL.js";import{Q as S,a as T}from"./QList-VUmXhwj_.js";import{Q as U}from"./QMarkupTable-D2m4a0kM.js";import{Q as B}from"./QSpace-tncuznwo.js";import{Q as G}from"./QPage-C34LN-3C.js";import{C as x}from"./ClosePopup-CTtYgOP7.js";import{_ as O}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./format-DyQxkAtJ.js";const q={name:"OasisProductosPage",data(){return{tipos:["Cirugía","Laboratorio","Peluqueria","Producto","Tratamiento"],productos:[],producto:{},productoDialog:!1,loading:!1,actionProducto:"",filter:"",filterTipo:"Todos",totalPages:1,currentPage:1}},mounted(){this.productosGet()},methods:{getColor(s){switch(s){case"Cirugía":return"red";case"Laboratorio":return"blue";case"Peluqueria":return"green";case"Producto":return"orange";case"Tratamiento":return"purple";default:return"grey"}},productoNew(){this.producto={codigo:"",nombre:"",precioCompra:0,precioVenta:0,stock:0,tipo:"Producto"},this.actionProducto="Nuevo",this.productoDialog=!0},productosGet(){this.loading=!0,this.$axios.get("oasis-productos",{params:{filter:this.filter,page:this.currentPage,limit:20,tipo:this.filterTipo==="Todos"?"":this.filterTipo}}).then(s=>{this.productos=s.data.data,this.totalPages=s.data.last_page}).catch(s=>{this.$alert.error(s.response?.data?.message||"Error al cargar")}).finally(()=>{this.loading=!1})},productoPost(){this.loading=!0,this.$axios.post("oasis-productos",this.producto).then(()=>{this.productoDialog=!1,this.productosGet(),this.$alert.success("Creado correctamente")}).catch(s=>{this.$alert.error(s.response?.data?.message||"Error al crear")}).finally(()=>{this.loading=!1})},productoPut(){this.loading=!0,this.$axios.put(`oasis-productos/${this.producto.id}`,this.producto).then(()=>{this.productoDialog=!1,this.productosGet(),this.$alert.success("Actualizado correctamente")}).catch(s=>{this.$alert.error(s.response?.data?.message||"Error al actualizar")}).finally(()=>{this.loading=!1})},productoEdit(s){this.producto={...s},this.actionProducto="Editar",this.productoDialog=!0},productoDelete(s){this.$alert.dialog("¿Eliminar producto?").onOk(()=>{this.loading=!0,this.$axios.delete(`oasis-productos/${s}`).then(()=>{this.productosGet(),this.$alert.success("Eliminado correctamente")}).catch(o=>{this.$alert.error(o.response?.data?.message||"Error al eliminar")}).finally(()=>{this.loading=!1})})}}},z={class:"row"},I={class:"col-8 col-md-3"},L={class:"col-4 col-md-2 flex flex-center"},F={class:"col-12 col-md-5 text-right"},M={class:"row"},A={class:"col-12 flex flex-center"},R={class:"text-bold text-sub"},W={class:"text-right"};function Z(s,o,j,H,t,i){return d(),p(G,{class:"q-pa-md"},{default:a(()=>[e(b,{flat:"",bordered:""},{default:a(()=>[e(g,null,{default:a(()=>[e(k,{onSubmit:i.productosGet},{default:a(()=>[r("div",z,[r("div",I,[e(n,{modelValue:t.filter,"onUpdate:modelValue":o[0]||(o[0]=l=>t.filter=l),label:"Buscar",outlined:"",dense:"",clearable:""},{prepend:a(()=>[e(f,{name:"search"})]),_:1},8,["modelValue"])]),o[11]||(o[11]=r("div",{class:"col-4 col-md-2"},null,-1)),r("div",L,[e(c,{color:"primary",label:"Buscar",type:"submit","no-caps":"",icon:"search",loading:t.loading},null,8,["loading"])]),r("div",F,[e(c,{color:"positive",label:"Nuevo",onClick:i.productoNew,"no-caps":"",icon:"add_circle_outline",loading:t.loading},null,8,["onClick","loading"])])])]),_:1},8,["onSubmit"]),r("div",M,[r("div",A,[t.totalPages>1?(d(),p(N,{key:0,modelValue:t.currentPage,"onUpdate:modelValue":[o[1]||(o[1]=l=>t.currentPage=l),i.productosGet],max:t.totalPages,"max-pages":5,"boundary-numbers":"",color:"black"},null,8,["modelValue","max","onUpdate:modelValue"])):y("",!0)])]),e(U,{dense:"","wrap-cells":"",flat:"",bordered:""},{default:a(()=>[o[14]||(o[14]=r("thead",{class:"bg-black text-white"},[r("tr",null,[r("td",null,"Opciones"),r("td",null,"Codigo"),r("td",null,"Nombre"),r("td",null,"Precio Compra"),r("td",null,"Precio Venta"),r("td",null,"Stock")])],-1)),r("tbody",null,[(d(!0),h(_,null,w(t.productos,l=>(d(),h("tr",{key:l.id},[r("td",null,[e(S,{dense:"",size:"10px",label:"Opciones","no-caps":"","dropdown-icon":"more_vert",color:"orange",loading:t.loading},{default:a(()=>[e(T,null,{default:a(()=>[V((d(),p(v,{clickable:"",onClick:Q=>i.productoEdit(l)},{default:a(()=>[e(m,{avatar:""},{default:a(()=>[e(f,{name:"edit"})]),_:1}),e(m,null,{default:a(()=>o[12]||(o[12]=[P("Editar")])),_:1})]),_:2},1032,["onClick"])),[[C],[x]]),V((d(),p(v,{clickable:"",onClick:Q=>i.productoDelete(l.id)},{default:a(()=>[e(m,{avatar:""},{default:a(()=>[e(f,{name:"delete"})]),_:1}),e(m,null,{default:a(()=>o[13]||(o[13]=[P("Eliminar")])),_:1})]),_:2},1032,["onClick"])),[[C],[x]])]),_:2},1024)]),_:2},1032,["loading"])]),r("td",null,u(l.codigo),1),r("td",null,u(l.nombre),1),r("td",null,u(l.precioCompra),1),r("td",null,u(l.precioVenta),1),r("td",null,u(l.stock),1)]))),128))])]),_:1})]),_:1})]),_:1}),e(D,{modelValue:t.productoDialog,"onUpdate:modelValue":o[10]||(o[10]=l=>t.productoDialog=l),persistent:"",position:"right",maximized:""},{default:a(()=>[e(b,{style:{"min-width":"350px"}},{default:a(()=>[e(g,{class:"q-pb-none row items-center"},{default:a(()=>[r("div",R,u(t.actionProducto)+" Oasis Producto ",1),e(B),e(c,{icon:"close",flat:"",round:"",dense:"",onClick:o[2]||(o[2]=l=>t.productoDialog=!1)})]),_:1}),e(g,null,{default:a(()=>[e(k,{onSubmit:o[9]||(o[9]=E(l=>t.producto.id?i.productoPut():i.productoPost(),["prevent"]))},{default:a(()=>[e(n,{modelValue:t.producto.codigo,"onUpdate:modelValue":o[3]||(o[3]=l=>t.producto.codigo=l),label:"Codigo",outlined:"",dense:""},null,8,["modelValue"]),e(n,{modelValue:t.producto.nombre,"onUpdate:modelValue":o[4]||(o[4]=l=>t.producto.nombre=l),label:"Nombre",outlined:"",dense:""},null,8,["modelValue"]),e(n,{modelValue:t.producto.precioCompra,"onUpdate:modelValue":o[5]||(o[5]=l=>t.producto.precioCompra=l),label:"Precio Compra",outlined:"",dense:"",type:"number",step:"0.01"},null,8,["modelValue"]),e(n,{modelValue:t.producto.precioVenta,"onUpdate:modelValue":o[6]||(o[6]=l=>t.producto.precioVenta=l),label:"Precio Venta",outlined:"",dense:"",type:"number",step:"0.01"},null,8,["modelValue"]),e(n,{modelValue:t.producto.stock,"onUpdate:modelValue":o[7]||(o[7]=l=>t.producto.stock=l),label:"Stock",outlined:"",dense:"",type:"number"},null,8,["modelValue"]),r("div",W,[e(c,{color:"negative",label:"Cancelar",onClick:o[8]||(o[8]=l=>t.productoDialog=!1),"no-caps":"",loading:t.loading},null,8,["loading"]),e(c,{color:"primary",label:"Guardar",type:"submit","no-caps":"",class:"q-ml-sm",loading:t.loading},null,8,["loading"])])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),o[15]||(o[15]=r("div",{id:"myElement",style:{display:"none"}},null,-1))]),_:1})}const so=O(q,[["render",Z]]);export{so as default};
